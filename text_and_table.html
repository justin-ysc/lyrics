<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>文字與表格示範</title>
  <style>
    :root{--accent:#2563eb;--muted:#6b7280;--bg:#f8fafc}
    *{box-sizing:border-box}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,'Noto Sans TC',Helvetica,Arial;line-height:1.5;margin:0;background:var(--bg);color:#0f172a;padding:24px}
    .container{max-width:900px;margin:0 auto;background:#fff;padding:24px;border-radius:12px;box-shadow:0 6px 18px rgba(15,23,42,0.06)}
    header{display:flex;align-items:center;gap:16px}
    h1{font-size:1.6rem;margin:0}
    p.lead{color:var(--muted);margin-top:8px}
    .controls{display:flex;gap:8px;margin-top:16px}
    button{background:var(--accent);color:#fff;border:0;padding:8px 12px;border-radius:8px;cursor:pointer;font-weight:600}
    button.secondary{background:#e6eefc;color:var(--accent);font-weight:600}
    table{width:100%;border-collapse:collapse;margin-top:18px}
    thead th{background:#f1f5f9;padding:10px;text-align:left;font-weight:700;border-bottom:2px solid #e6eefc}
    tbody td{padding:10px;border-bottom:1px solid #eef2ff}
    tbody tr:hover{background:#fbfdff}
    .muted{color:var(--muted);font-size:0.9rem}
    .tag{display:inline-block;padding:4px 8px;border-radius:999px;font-size:0.85rem;background:#eef2ff;color:var(--accent);font-weight:600}
    @media (max-width:640px){
      .container{padding:16px}
      h1{font-size:1.2rem}
      thead th,tbody td{padding:8px}
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1>專案報表示範 <span class="tag">v1</span></h1>
        <p class="lead">這是一個簡潔的 HTML 範例，示範如何呈現說明文字與資料表格，並提供匯出功能。</p>
      </div>
    </header>

    <section style="margin-top:18px">
      <h2 style="margin:0 0 8px 0">說明</h2>
      <p class="muted">下方表格包含範例資料。你可以編輯、排序或透過「匯出 CSV」按鈕將資料下載成檔案。</p>
      <div class="controls">
        <button id="addRow">新增列</button>
        <button id="exportCsv" class="secondary">匯出 CSV</button>
        <button id="printBtn" class="secondary">列印</button>
      </div>
    </section>

    <section>
      <table id="dataTable" aria-label="範例資料表">
        <thead>
          <tr>
            <th>#</th>
            <th>名稱</th>
            <th>狀態</th>
            <th>進度</th>
            <th>備註</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>1</td>
            <td>企劃撰寫</td>
            <td>完成</td>
            <td>100%</td>
            <td>無</td>
          </tr>
          <tr>
            <td>2</td>
            <td>設計階段</td>
            <td>進行中</td>
            <td>60%</td>
            <td>需確認色彩</td>
          </tr>
          <tr>
            <td>3</td>
            <td>開發實作</td>
            <td>尚未開始</td>
            <td>0%</td>
            <td>等待資源分配</td>
          </tr>
        </tbody>
      </table>
    </section>

  </div>

  <script>
    const table = document.getElementById('dataTable').querySelector('tbody');
    const addRowBtn = document.getElementById('addRow');
    const exportBtn = document.getElementById('exportCsv');
    const printBtn = document.getElementById('printBtn');

    addRowBtn.addEventListener('click', () => {
      const idx = table.rows.length + 1;
      const tr = document.createElement('tr');
      tr.innerHTML = `\n        <td>${idx}</td>\n        <td contenteditable>新項目</td>\n        <td contenteditable>尚未開始</td>\n        <td contenteditable>0%</td>\n        <td contenteditable>備註</td>\n      `;
      table.appendChild(tr);
      tr.querySelectorAll('[contenteditable]').forEach(cell => cell.focus());
    });

    function tableToCSV() {
      const rows = [];
      const headers = Array.from(document.querySelectorAll('#dataTable thead th')).map(h => h.innerText.trim());
      rows.push(headers.join(','));
      Array.from(table.rows).forEach(r => {
        const cols = Array.from(r.cells).map(c => '"' + c.innerText.replace(/"/g,'""') + '"');
        rows.push(cols.join(','));
      });
      return rows.join('\n');
    }

    exportBtn.addEventListener('click', () => {
      const csv = tableToCSV();
      const blob = new Blob([csv], {type: 'text/csv;charset=utf-8;'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'report.csv';
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    });

    printBtn.addEventListener('click', () => window.print());
  </script>
</body>
</html>
